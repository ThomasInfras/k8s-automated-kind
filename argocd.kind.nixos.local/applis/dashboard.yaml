apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: homepage
  namespace: argocd
spec:
  project: default
  source:
    repoURL: 'https://jameswynn.github.io/helm-charts'
    chart: homepage
    targetRevision: ">0.0.0" 
    helm:
      valueFiles:
        - values.yaml 
      values: |
      ingress:
        main:
          enabled: true
          labels:
            # This label will enable discover of this deployment in Homepage
            gethomepage.dev/enabled: "true"
          annotations:
            # These annotations will configure how this deployment is shown in Homepage
            gethomepage.dev/name: "Homepage"
            gethomepage.dev/description: "A modern, secure, highly customizable application dashboard."
            gethomepage.dev/group: "A New Group"
            gethomepage.dev/icon: "homepage.png"
          ingressClassName: "nginx"
          hosts:
            - host: &host "homepage.kind.nixos.local"
              paths:
                - path: /
                  pathType: Prefix

  destination:
    server: 'https://kubernetes.default.svc'
    namespace: homepage  # Changez le namespace si n√©cessaire
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true   